/**
 * Zepto picLazyLoad Plugin
 * 西门 http://ons.me/484.html
 * 20140517 v1.0
 */
;(function($){$.fn.picLazyLoad=function(settings){var $this=$(this),_winScrollTop=0,_winHeight=$(window).height();settings=$.extend({threshold:0,placeholder:'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC'},settings||{});lazyLoadPic();settings.element=settings.element||$(window);settings.element.on('scroll',function(){_winScrollTop=$(window).scrollTop();lazyLoadPic()});function lazyLoadPic(){$this.each(function(){var $self=$(this);if($self.is('img')){if($self.attr('data-original')){var _offsetTop=$self.offset().top;if((_offsetTop-settings.threshold)<=(_winHeight+_winScrollTop)){$self.attr('src',$self.attr('data-original'));$self.removeAttr('data-original')}}}else{if($self.attr('data-original')){if($self.css('background-image')=='none'){$self.css('background-image','url('+settings.placeholder+')')}var _offsetTop=$self.offset().top;if((_offsetTop-settings.threshold)<=(_winHeight+_winScrollTop)){$self.css('background-image','url('+$self.attr('data-original')+')');$self.removeAttr('data-original')}}}})}}})(Zepto);
;// Zepto.cookie plugin
// 
// Copyright (c) 2010, 2012 
// @author Klaus Hartl (stilbuero.de)
// @author Daniel Lacy (daniellacy.com)
// 
// Dual licensed under the MIT and GPL licenses:
// http://www.opensource.org/licenses/mit-license.php
// http://www.gnu.org/licenses/gpl.html
(function(a){a.extend(a.fn,{cookie:function(b,c,d){var e,f,g,h;if(arguments.length>1&&String(c)!=="[object Object]"){d=a.extend({},d);if(c===null||c===undefined)d.expires=-1;return typeof d.expires=="number"&&(e=d.expires*24*60*60*1e3,f=d.expires=new Date,f.setTime(f.getTime()+e)),c=String(c),document.cookie=[encodeURIComponent(b),"=",d.raw?c:encodeURIComponent(c),d.expires?"; expires="+d.expires.toUTCString():"",d.path?"; path="+d.path:"",d.domain?"; domain="+d.domain:"",d.secure?"; secure":""].join("")}return d=c||{},h=d.raw?function(a){return a}:decodeURIComponent,(g=(new RegExp("(?:^|; )"+encodeURIComponent(b)+"=([^;]*)")).exec(document.cookie))?h(g[1]):null}})})(Zepto);
;;(function($,undefined){var prefix='',eventPrefix,vendors={Webkit:'webkit',Moz:'',O:'o'},testEl=document.createElement('div'),supportedTransforms=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i,transform,transitionProperty,transitionDuration,transitionTiming,transitionDelay,animationName,animationDuration,animationTiming,animationDelay,cssReset={};function dasherize(str){return str.replace(/([A-Z])/g,'-$1').toLowerCase()}function normalizeEvent(name){return eventPrefix?eventPrefix+name:name.toLowerCase()}if(testEl.style.transform===undefined)$.each(vendors,function(vendor,event){if(testEl.style[vendor+'TransitionProperty']!==undefined){prefix='-'+vendor.toLowerCase()+'-';eventPrefix=event;return false}});transform=prefix+'transform';cssReset[transitionProperty=prefix+'transition-property']=cssReset[transitionDuration=prefix+'transition-duration']=cssReset[transitionDelay=prefix+'transition-delay']=cssReset[transitionTiming=prefix+'transition-timing-function']=cssReset[animationName=prefix+'animation-name']=cssReset[animationDuration=prefix+'animation-duration']=cssReset[animationDelay=prefix+'animation-delay']=cssReset[animationTiming=prefix+'animation-timing-function']='';$.fx={off:(eventPrefix===undefined&&testEl.style.transitionProperty===undefined),speeds:{_default:400,fast:200,slow:600},cssPrefix:prefix,transitionEnd:normalizeEvent('TransitionEnd'),animationEnd:normalizeEvent('AnimationEnd')};$.fn.animate=function(properties,duration,ease,callback,delay){if($.isFunction(duration))callback=duration,ease=undefined,duration=undefined;if($.isFunction(ease))callback=ease,ease=undefined;if($.isPlainObject(duration))ease=duration.easing,callback=duration.complete,delay=duration.delay,duration=duration.duration;if(duration)duration=(typeof duration=='number'?duration:($.fx.speeds[duration]||$.fx.speeds._default))/1000;if(delay)delay=parseFloat(delay)/1000;return this.anim(properties,duration,ease,callback,delay)};$.fn.anim=function(properties,duration,ease,callback,delay){var key,cssValues={},cssProperties,transforms='',that=this,wrappedCallback,endEvent=$.fx.transitionEnd,fired=false;if(duration===undefined)duration=$.fx.speeds._default/1000;if(delay===undefined)delay=0;if($.fx.off)duration=0;if(typeof properties=='string'){cssValues[animationName]=properties;cssValues[animationDuration]=duration+'s';cssValues[animationDelay]=delay+'s';cssValues[animationTiming]=(ease||'linear');endEvent=$.fx.animationEnd}else{cssProperties=[];for(key in properties)if(supportedTransforms.test(key))transforms+=key+'('+properties[key]+') ';else cssValues[key]=properties[key],cssProperties.push(dasherize(key));if(transforms)cssValues[transform]=transforms,cssProperties.push(transform);if(duration>0&&typeof properties==='object'){cssValues[transitionProperty]=cssProperties.join(', ');cssValues[transitionDuration]=duration+'s';cssValues[transitionDelay]=delay+'s';cssValues[transitionTiming]=(ease||'linear')}}wrappedCallback=function(event){if(typeof event!=='undefined'){if(event.target!==event.currentTarget)return;$(event.target).unbind(endEvent,wrappedCallback)}else $(this).unbind(endEvent,wrappedCallback);fired=true;$(this).css(cssReset);callback&&callback.call(this)};if(duration>0){this.bind(endEvent,wrappedCallback);setTimeout(function(){if(fired)return;wrappedCallback.call(that)},((duration+delay)*1000)+25)}this.size()&&this.get(0).clientLeft;this.css(cssValues);if(duration<=0)setTimeout(function(){that.each(function(){wrappedCallback.call(this)})},0);return this};testEl=null})(Zepto);
;(function(){if(window.WEB_SOCKET_FORCE_FLASH){}else if(window.WebSocket){return;}else if(window.MozWebSocket){window.WebSocket=MozWebSocket;return;}
var logger;if(window.WEB_SOCKET_LOGGER){logger=WEB_SOCKET_LOGGER;}else if(window.console&&window.console.log&&window.console.error){logger=window.console;}else{logger={log:function(){},error:function(){}};}
if(swfobject.getFlashPlayerVersion().major<10){logger.error("Flash Player >= 10.0.0 is required.");return;}
if(location.protocol=="file:"){logger.error("WARNING: web-socket-js doesn't work in file:///... URL "+"unless you set Flash Security Settings properly. "+"Open the page via Web server i.e. http://...");}
window.WebSocket=function(url,protocols,proxyHost,proxyPort,headers){var self=this;self.__id=WebSocket.__nextId++;WebSocket.__instances[self.__id]=self;self.readyState=WebSocket.CONNECTING;self.bufferedAmount=0;self.__events={};if(!protocols){protocols=[];}else if(typeof protocols=="string"){protocols=[protocols];}
self.__createTask=setTimeout(function(){WebSocket.__addTask(function(){self.__createTask=null;WebSocket.__flash.create(self.__id,url,protocols,proxyHost||null,proxyPort||0,headers||null);});},0);};WebSocket.prototype.send=function(data){if(this.readyState==WebSocket.CONNECTING){throw"INVALID_STATE_ERR: Web Socket connection has not been established";}
var result=WebSocket.__flash.send(this.__id,encodeURIComponent(data));if(result<0){return true;}else{this.bufferedAmount+=result;return false;}};WebSocket.prototype.close=function(){if(this.__createTask){clearTimeout(this.__createTask);this.__createTask=null;this.readyState=WebSocket.CLOSED;return;}
if(this.readyState==WebSocket.CLOSED||this.readyState==WebSocket.CLOSING){return;}
this.readyState=WebSocket.CLOSING;WebSocket.__flash.close(this.__id);};WebSocket.prototype.addEventListener=function(type,listener,useCapture){if(!(type in this.__events)){this.__events[type]=[];}
this.__events[type].push(listener);};WebSocket.prototype.removeEventListener=function(type,listener,useCapture){if(!(type in this.__events))return;var events=this.__events[type];for(var i=events.length-1;i>=0;--i){if(events[i]===listener){events.splice(i,1);break;}}};WebSocket.prototype.dispatchEvent=function(event){var events=this.__events[event.type]||[];for(var i=0;i<events.length;++i){events[i](event);}
var handler=this["on"+event.type];if(handler)handler.apply(this,[event]);};WebSocket.prototype.__handleEvent=function(flashEvent){if("readyState"in flashEvent){this.readyState=flashEvent.readyState;}
if("protocol"in flashEvent){this.protocol=flashEvent.protocol;}
var jsEvent;if(flashEvent.type=="open"||flashEvent.type=="error"){jsEvent=this.__createSimpleEvent(flashEvent.type);}else if(flashEvent.type=="close"){jsEvent=this.__createSimpleEvent("close");jsEvent.wasClean=flashEvent.wasClean?true:false;jsEvent.code=flashEvent.code;jsEvent.reason=flashEvent.reason;}else if(flashEvent.type=="message"){var data=decodeURIComponent(flashEvent.message);jsEvent=this.__createMessageEvent("message",data);}else{throw"unknown event type: "+flashEvent.type;}
this.dispatchEvent(jsEvent);};WebSocket.prototype.__createSimpleEvent=function(type){if(document.createEvent&&window.Event){var event=document.createEvent("Event");event.initEvent(type,false,false);return event;}else{return{type:type,bubbles:false,cancelable:false};}};WebSocket.prototype.__createMessageEvent=function(type,data){if(window.MessageEvent&&typeof(MessageEvent)=="function"&&!window.opera){return new MessageEvent("message",{"view":window,"bubbles":false,"cancelable":false,"data":data});}else if(document.createEvent&&window.MessageEvent&&!window.opera){var event=document.createEvent("MessageEvent");event.initMessageEvent("message",false,false,data,null,null,window,null);return event;}else{return{type:type,data:data,bubbles:false,cancelable:false};}};WebSocket.CONNECTING=0;WebSocket.OPEN=1;WebSocket.CLOSING=2;WebSocket.CLOSED=3;WebSocket.__isFlashImplementation=true;WebSocket.__initialized=false;WebSocket.__flash=null;WebSocket.__instances={};WebSocket.__tasks=[];WebSocket.__nextId=0;WebSocket.loadFlashPolicyFile=function(url){WebSocket.__addTask(function(){WebSocket.__flash.loadManualPolicyFile(url);});};WebSocket.__initialize=function(){if(WebSocket.__initialized)return;WebSocket.__initialized=true;if(WebSocket.__swfLocation){window.WEB_SOCKET_SWF_LOCATION=WebSocket.__swfLocation;}
if(!window.WEB_SOCKET_SWF_LOCATION){logger.error("[WebSocket] set WEB_SOCKET_SWF_LOCATION to location of WebSocketMain.swf");return;}
if(!window.WEB_SOCKET_SUPPRESS_CROSS_DOMAIN_SWF_ERROR&&!WEB_SOCKET_SWF_LOCATION.match(/(^|\/)WebSocketMainInsecure\.swf(\?.*)?$/)&&WEB_SOCKET_SWF_LOCATION.match(/^\w+:\/\/([^\/]+)/)){var swfHost=RegExp.$1;if(location.host!=swfHost){logger.error("[WebSocket] You must host HTML and WebSocketMain.swf in the same host "+"('"+location.host+"' != '"+swfHost+"'). "+"See also 'How to host HTML file and SWF file in different domains' section "+"in README.md. If you use WebSocketMainInsecure.swf, you can suppress this message "+"by WEB_SOCKET_SUPPRESS_CROSS_DOMAIN_SWF_ERROR = true;");}}
var container=document.createElement("div");container.id="webSocketContainer";container.style.position="absolute";if(WebSocket.__isFlashLite()){container.style.left="0px";container.style.top="0px";}else{container.style.left="-100px";container.style.top="-100px";}
var holder=document.createElement("div");holder.id="webSocketFlash";container.appendChild(holder);document.body.appendChild(container);swfobject.embedSWF(WEB_SOCKET_SWF_LOCATION,"webSocketFlash","1","1","10.0.0",null,null,{hasPriority:true,swliveconnect:true,allowScriptAccess:"always"},null,function(e){if(!e.success){logger.error("[WebSocket] swfobject.embedSWF failed");}});};WebSocket.__onFlashInitialized=function(){setTimeout(function(){WebSocket.__flash=document.getElementById("webSocketFlash");WebSocket.__flash.setCallerUrl(location.href);WebSocket.__flash.setDebug(!!window.WEB_SOCKET_DEBUG);for(var i=0;i<WebSocket.__tasks.length;++i){WebSocket.__tasks[i]();}
WebSocket.__tasks=[];},0);};WebSocket.__onFlashEvent=function(){setTimeout(function(){try{var events=WebSocket.__flash.receiveEvents();for(var i=0;i<events.length;++i){WebSocket.__instances[events[i].webSocketId].__handleEvent(events[i]);}}catch(e){logger.error(e);}},0);return true;};WebSocket.__log=function(message){logger.log(decodeURIComponent(message));};WebSocket.__error=function(message){logger.error(decodeURIComponent(message));};WebSocket.__addTask=function(task){if(WebSocket.__flash){task();}else{WebSocket.__tasks.push(task);}};WebSocket.__isFlashLite=function(){if(!window.navigator||!window.navigator.mimeTypes){return false;}
var mimeType=window.navigator.mimeTypes["application/x-shockwave-flash"];if(!mimeType||!mimeType.enabledPlugin||!mimeType.enabledPlugin.filename){return false;}
return mimeType.enabledPlugin.filename.match(/flashlite/i)?true:false;};if(!window.WEB_SOCKET_DISABLE_AUTO_INITIALIZATION){swfobject.addDomLoadEvent(function(){WebSocket.__initialize();});}})();;(function(window){var emojis={"qq":{"name":"QQ表情","col":8,"path":window.sysinfo.mobile_path+"images/arclist/","enable":true,"sources":[{title:'微笑',url:'00.gif'},{title:'撇嘴',url:'01.gif'},{title:'色',url:'02.gif'},{title:'发呆',url:'03.gif'},{title:'得意',url:'04.gif'},{title:'流泪',url:'05.gif'},{title:'害羞',url:'06.gif'},{title:'闭嘴',url:'07.gif'},{title:'睡',url:'08.gif'},{title:'大哭',url:'09.gif'},{title:'尴尬',url:'10.gif'},{title:'发怒',url:'11.gif'},{title:'调皮',url:'12.gif'},{title:'呲牙',url:'13.gif'},{title:'惊讶',url:'14.gif'},{title:'难过',url:'15.gif'},{title:'吓',url:'16.gif'},{title:'囧',url:'17.gif'},{title:'抓狂',url:'18.gif'},{title:'吐',url:'19.gif'},{title:'偷笑',url:'20.gif'},{title:'愉快',url:'21.gif'},{title:'白眼',url:'22.gif'},{title:'傲慢',url:'23.gif'},{title:'馋',url:'24.gif'},{title:'困',url:'25.gif'},{title:'惊恐',url:'26.gif'},{title:'流汗',url:'27.gif'},{title:'憨笑',url:'28.gif'},{title:'悠闲',url:'29.gif'},{title:'奋斗',url:'30.gif'},{title:'咒骂',url:'31.gif'},{title:'疑问',url:'32.gif'},{title:'嘘',url:'33.gif'},{title:'晕',url:'34.gif'},{title:'衰',url:'36.gif'},{title:'骷髅',url:'37.gif'},{title:'敲打',url:'38.gif'},{title:'再见',url:'39.gif'},{title:'擦汗',url:'40.gif'},{title:'抠鼻',url:'41.gif'},{title:'鼓掌',url:'42.gif'},{title:'尴尬',url:'43.gif'},{title:'坏笑',url:'44.gif'},{title:'左哼哼',url:'45.gif'},{title:'右哼哼',url:'46.gif'},{title:'哈欠',url:'47.gif'},{title:'鄙视',url:'48.gif'},{title:'委屈',url:'49.gif'},{title:'快哭了',url:'50.gif'},{title:'阴险',url:'51.gif'},{title:'亲亲',url:'52.gif'},{title:'惊吓',url:'53.gif'},{title:'可怜',url:'54.gif'},{title:'菜刀',url:'55.gif'},{title:'西瓜',url:'56.gif'},{title:'啤酒',url:'57.gif'},{title:'篮球',url:'58.gif'},{title:'乒乓球',url:'59.gif'},{title:'咖啡',url:'60.gif'},{title:'米饭',url:'61.gif'},{title:'猪头',url:'62.gif'},{title:'玫瑰',url:'63.gif'},{title:'枯萎',url:'64.gif'},{title:'爱',url:'65.gif'},{title:'心',url:'66.gif'},{title:'心碎',url:'67.gif'},{title:'蛋糕',url:'68.gif'},{title:'闪电',url:'69.gif'},{title:'炸弹',url:'70.gif'},{title:'匕首',url:'71.gif'},{title:'足球',url:'72.gif'},{title:'瓢虫',url:'73.gif'},{title:'便便',url:'74.gif'},{title:'月亮',url:'75.gif'},{title:'太阳',url:'76.gif'},{title:'礼物',url:'77.gif'},{title:'拥抱',url:'78.gif'},{title:'太强了',url:'79.gif'},{title:'太弱了',url:'80.gif'},{title:'握手',url:'81.gif'},{title:'YEAH',url:'82.gif'},{title:'承认',url:'83.gif'},{title:'勾引',url:'84.gif'},{title:'握拳',url:'85.gif'},{title:'拉勾',url:'86.gif'},{title:'LOVE',url:'87.gif'},{title:'NO',url:'88.gif'},{title:'OK',url:'89.gif'},{title:'相爱',url:'90.gif'},{title:'飞吻',url:'91.gif'},{title:'摇摆',url:'92.gif'},{title:'发抖',url:'93.gif'},{title:'大叫',url:'94.gif'},{title:'转圈',url:'95.gif'},{title:'鞠躬',url:'96.gif'},{title:'偷吃',url:'97.gif'},{title:'跳绳',url:'98.gif'},{title:'擦泪',url:'99.gif'},{title:'哭',url:'100.gif'},{title:'呐喊',url:'101.gif'},{title:'飞吻',url:'102.gif'},{title:'右碰碰',url:'103.gif'},{title:'左碰碰',url:'104.gif'},{title:'口罩',url:'105.gif'},{title:'查找',url:'107.gif'},{title:'美眉',url:'108.gif'},{title:'小猫',url:'109.gif'},{title:'小狗',url:'110.gif'},{title:'钱',url:'111.gif'},{title:'音乐',url:'112.gif'},{title:'药',url:'113.gif'},{title:'吻',url:'114.gif'}]},};window.emojis=emojis;})(window);(function(){var wantEmoji=function(options){options=options||{};var selector=options.wrapper||"body";this.wrapper=document.querySelector(selector);this.row=options.row||4;this.callback=options.callback||function(){};this.emojis=window.emojis||emojis;this.content=null;this.navRow=null;this.currentWrapper=null;this.activePage=0;this.totalPage=0;this.eachPartsNum=4;this.wrapWidth=0;this.count=this.getEMJPackageCount();if(options.autoInit)
this.init();};wantEmoji.prototype={init:function(){if(this.count>this.eachPartsNum)
this.wrapper.className+=" wEmoji wEmoji-more";else
this.wrapper.className+=" wEmoji";this.wrapWidth=this.wrapper.clientWidth-20;this.initTemplete();},initTemplete:function(){var wrapper=this.wrapper,tpl='<div class="wEmoji-header">'+'<div class="wEmoji-prev-btn">&lt;</div>'+'<div class="wEmoji-nav">'+'<div class="wEmoji-row"></div>'+'</div>'+'<div class="wEmoji-next-btn">&gt;</div>'+'</div>'+'<div class="wEmoji-container">'+'<div class="wEmoji-content"></div>'+'<div class="wEmoji-pages"></div>'+'</div>';wrapper.innerHTML=tpl;this.content=wrapper.querySelector(".wEmoji-content");this.navRow=wrapper.querySelector(".wEmoji-row");this.__initData();this.__bindEvent();},__initData:function(){var emojis=this.emojis,wrapper=this.wrapper,navRow=this.navRow,content=this.content,rowWidth=navRow.clientWidth,count=this.count;wrapper.style.display="none";content.innerHTML="";navRow.style.width=count/this.eachPartsNum*100+"%";for(var key in emojis){var emj=emojis[key];if(!emj.enable)
continue;content.appendChild(this.__initContent(key,emj));navRow.innerHTML+='<div class="wEmoji-list" data-eid="'+key+'" style="width:'+(1/count*100)+'%;">'+emj.name+'</div>';}
this.__initStyle();this.wrapper.style.display="block";},__initStyle:function(){this.chooseEmoji("qq");this.__createPageList();},__initContent:function(key,emj){var row=this.row,col=emj.col,wrapWidth=this.wrapWidth,sources=emj.sources,path=emj.path,totalNum=sources.length,eachPageNum=col*row,pageNum=Math.ceil(totalNum/eachPageNum),column=document.createElement("div");column.className="wEmoji-wrapper";column.setAttribute("data-eid",key);column.setAttribute("data-pageNum",pageNum);column.style.width=wrapWidth*pageNum+"px";for(var p=0;p<pageNum;p++){var tempPage=document.createElement("div"),temp="",idx;tempPage.className="wEmoji-column";tempPage.style.width=wrapWidth+"px";for(var i=0;i<eachPageNum;i++){var url,code,title="",source,isObject;idx=p*eachPageNum+i;source=sources[idx];isObject=(typeof source=="object");url=isObject?source.url:source;title=isObject?source.title:"";if(!url){break;}
var imgArr=url.split("."),type=imgArr.pop();code='['+title+']';temp+='<div class="wEmoji-item" data-emj="'+code+'" style="width:'+(100/col)+'%;">'+'<img src="'+path+url+'" title="'+title+'" />'+'</div>';}
tempPage.innerHTML=temp;column.appendChild(tempPage);}
return column;},__createPageList:function(){var pageNum=this.currentWrapper.getAttribute("data-pageNum"),pageWrapper=this.wrapper.querySelector(".wEmoji-pages"),temp="";for(var i=1;i<=pageNum;i++){temp+='<span class="wEmoji-page-list" data-pageIdx="'+i+'"></span>';}
temp+='<i class="iconfont icon-delete delete-emoji"></i>'
pageWrapper.innerHTML=temp;this.totalPage=pageNum;this.showPage(0);},__bindEvent:function(){var _self=this,wrapper=this.wrapper,row=this.navRow,pageBox=wrapper.querySelector('.wEmoji-pages'),prev=wrapper.querySelector('.wEmoji-prev-btn'),next=wrapper.querySelector('.wEmoji-next-btn'),del=wrapper.querySelector('.delete-emoji'),content=this.content,down="ontouchstart"in document?"touchstart":"mousedown",up="ontouchend"in document?"touchend":"mouseup",move="ontouchmove"in document?"touchmove":"mousemove",drag=false,x=0;pageBox.onclick=function(e){e=e||event;var target=e.target||e.srcElement,idx=target.getAttribute("data-pageIdx");if(target.tagName.toLowerCase()!="li"||!idx){return false;}
_self.showPage(idx-1);};del.onclick=function(e){var reg=/\[[A-Z]*[\u4E00-\u9FA5]*\]/g;var text=$('.txtMessage').val();var del_list=text.match(reg);if(del_list.length>0){for(var i=del_list.length-1;i>=0;i--){if(del_list[i]){text=text.replace(del_list[i],'');break;}}}
$('.txtMessage').val(text);};row.onclick=function(e){e=e||event;var target=e.target||e.srcElement,eid=target.getAttribute("data-eid");if(eid&&_self.emojis[eid]){_self.chooseEmoji(eid);_self.showPage(0);}};var parts=Math.ceil(this.count/this.eachPartsNum),partsIdx=0,navWidth=wrapper.querySelector(".wEmoji-nav").clientWidth;prev.onclick=function(e){partsIdx=partsIdx-1<0?0:partsIdx-1;row.style.webkitTransform="translateX("+(-partsIdx*navWidth)+"px) translateZ(0px)";row.style.transform="translateX("+(-partsIdx*navWidth)+"px) translateZ(0px)";};next.onclick=function(e){partsIdx=partsIdx+1>=parts?partsIdx:partsIdx+1;row.style.webkitTransform="translateX("+(-partsIdx*navWidth)+"px) translateZ(0px)";row.style.transform="translateX("+(-partsIdx*navWidth)+"px) translateZ(0px)";};content.onclick=function(e){e=e||event;var target=e.target||e.srcElement,trueTarget=getTargetNode(target,".wEmoji-item"),emjCode;if(trueTarget)
emjCode=trueTarget.getAttribute("data-emj");if(!emjCode)
return false;_self.callback.call(_self,emjCode);console.log(emjCode);};content["on"+down]=function(e){e=e||event;drag=true;x=e.pageX||e.touches[0].pageX;};document.addEventListener(move,function(e){e=e||event;e.stopPropagation();e.preventDefault();});content["on"+up]=function(e){e=e||event;if(drag){drag=false;var endX=e.pageX||e.changedTouches[0].pageX,dis=endX-x,idx;if(dis>50){idx=Math.max(_self.activePage-1,0);_self.showPage(idx);}else if(dis<-50){idx=Math.min(_self.activePage+1,_self.totalPage-1);_self.showPage(idx);}
x=0;}};},chooseEmoji:function(eid){var navRow=this.navRow,content=this.content,targetWrapper=content.querySelector(".wEmoji-wrapper[data-eid='"+eid+"']"),targetList=navRow.querySelector(".wEmoji-list[data-eid='"+eid+"']"),chooseWrapper=content.querySelector(".wEmoji-wrapper[data-choose='true']"),chooseList=navRow.querySelector(".wEmoji-list[data-choose='true']");if(chooseWrapper){chooseList.setAttribute("data-choose","false");chooseWrapper.setAttribute("data-choose","false");}
targetWrapper.setAttribute("data-choose","true");targetList.setAttribute("data-choose","true");this.currentWrapper=targetWrapper;this.__createPageList();},showPage:function(idx){this.activePage=idx;var wrapper=this.wrapper,currentWrapper=this.currentWrapper,pageTargetList=wrapper.querySelector(".wEmoji-page-list[data-pageIdx='"+(idx+1)+"']"),pageChoose=wrapper.querySelector(".wEmoji-page-list[data-choose='true']");if(pageChoose)
pageChoose.setAttribute("data-choose","false");pageTargetList.setAttribute("data-choose","true");currentWrapper.style.webkitTransform="translateX("+(-this.wrapWidth*idx)+"px) translateZ(0px)";currentWrapper.style.transform="translateX("+(-this.wrapWidth*idx)+"px) translateZ(0px)";},explain:function(str){var reg=new RegExp(/\[[A-Z]*[\u4E00-\u9FA5]*\]/,'g'),_self=this;return str.replace(reg,function(str,target){var list=_self.emojis.qq.sources;var path=_self.emojis.qq.path;for(var i=0;i<list.length;i++){var title='['+list[i].title+']';if(title==str){return'<img src="'+path+list[i].url+'" />';}}});},getEMJPackageCount:function(){var emojis=this.emojis,count=0;for(var key in emojis){if(emojis[key].enable){count++;}}
return count;}};var getTargetNode=function(ele,selector){var type=getSelectorType(selector),nSec=selector.replace(/.|#/,"");if(ele===document){return null;}
if(new RegExp(nSec).test(ele[type])){return ele;}else{return getTargetNode(ele.parentNode,selector);}};var getSelectorType=(function(){var checkIdName=function(selector){var idReg=new RegExp("#");return(idReg.test(selector)?"id":checkClassName(selector));};var checkClassName=function(selector){var classReg=new RegExp(".");return(classReg.test(selector)?"className":"tagName");};return function(selector){return checkIdName(selector);};})();if(typeof module!="undefined"&&module.exports){module.exports=wantEmoji;}else if(typeof define=="function"&&define.amd){define(function(){return wantEmoji;});}else{window.wantEmoji=wantEmoji;}})(window,document,undefined)